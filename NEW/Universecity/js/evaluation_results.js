
// var options = {
//   series: [{
//   name: 'Βαθμός 0',
//   data: [44, 55]
// }, {
//   name: 'Βαθμός 1',
//   data: [13, 23]
// }, {
//   name: 'Βαθμός 2',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 3',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 4',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 5',
//   data: [11, 17]
// }],
//   chart: {
//   type: 'bar',
//   height: 400,
//   stacked: true,
//   stackType: '100%'
// },
// responsive: [{
//   breakpoint: 480,
//   options: {
//     legend: {
//       position: 'bottom',
//       offsetX: -10,
//       offsetY: 0
//     }
//   }
// }],
// xaxis: {
//   categories: ['Q1', 'Q2']
// },
// fill: {
//   opacity: 1
// },
// legend: {
//   position: 'right',
//   offsetX: 0,
//   offsetY: 50
// },
// title: {
//   text: 'Γενικές ερωτήσεις'
// }
// };

// var chart = new ApexCharts(document.querySelector(".chartGeneralQuestions"), options);
// chart.render();

// var options = {
//   series: [{
//   name: 'Βαθμός 0',
//   data: [44, 55, 10]
// }, {
//   name: 'Βαθμός 1',
//   data: [13, 23, 12]
// }, {
//   name: 'Βαθμός 2',
//   data: [11, 17, 13]
// },{
//   name: 'Βαθμός 3',
//   data: [11, 17, 15]
// },{
//   name: 'Βαθμός 4',
//   data: [11, 17, 50]
// },{
//   name: 'Βαθμός 5',
//   data: [11, 17, 46]
// }],
//   chart: {
//   type: 'bar',
//   height: 400,
//   stacked: true,
//   stackType: '100%'
// },
// responsive: [{
//   breakpoint: 480,
//   options: {
//     legend: {
//       position: 'bottom',
//       offsetX: -10,
//       offsetY: 0
//     }
//   }
// }],
// xaxis: {
//   categories: ['Q3', 'Q4', 'Q5']
// },
// fill: {
//   opacity: 1
// },
// legend: {
//   position: 'right',
//   offsetX: 0,
//   offsetY: 50
// },
// title: {
//   text: 'Αξιολόγηση μαθήματος'
// }
// };

// var chart = new ApexCharts(document.querySelector(".chartEvalSubject"), options);
// chart.render();


// var options = {
//   series: [{
//   name: 'Βαθμός 0',
//   data: [44, 55, 10, 23]
// }, {
//   name: 'Βαθμός 1',
//   data: [13, 23, 12, 45]
// }, {
//   name: 'Βαθμός 2',
//   data: [11, 17, 13, 46]
// },{
//   name: 'Βαθμός 3',
//   data: [11, 17, 15, 40]
// },{
//   name: 'Βαθμός 4',
//   data: [11, 17, 50, 31]
// },{
//   name: 'Βαθμός 5',
//   data: [11, 17, 46, 56]
// }],
//   chart: {
//   type: 'bar',
//   height: 400,
//   stacked: true,
//   stackType: '100%'
// },
// responsive: [{
//   breakpoint: 480,
//   options: {
//     legend: {
//       position: 'bottom',
//       offsetX: -10,
//       offsetY: 0
//     }
//   }
// }],
// xaxis: {
//   categories: ['Q6', 'Q7', 'Q8', 'Q9']
// },
// fill: {
//   opacity: 1
// },
// legend: {
//   position: 'right',
//   offsetX: 0,
//   offsetY: 50
// },
// title: {
//   text: 'Αξιολόγηση διδασκόντος'
// }
// };

// var chart = new ApexCharts(document.querySelector(".chartEvalTeacher"), options);
// chart.render();

// var options = {
//   series: [{
//   name: 'Βαθμός 0',
//   data: [44, 55]
// }, {
//   name: 'Βαθμός 1',
//   data: [13, 23]
// }, {
//   name: 'Βαθμός 2',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 3',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 4',
//   data: [11, 17]
// },{
//   name: 'Βαθμός 5',
//   data: [11, 17]
// }],
//   chart: {
//   type: 'bar',
//   height: 400,
//   stacked: true,
//   stackType: '100%'
// },
// responsive: [{
//   breakpoint: 480,
//   options: {
//     legend: {
//       position: 'bottom',
//       offsetX: -10,
//       offsetY: 0
//     }
//   }
// }],
// xaxis: {
//   categories: ['Q6', 'Q7']
// },
// fill: {
//   opacity: 1
// },
// legend: {
//   position: 'right',
//   offsetX: 0,
//   offsetY: 50
// },
// title: {
//   text: 'Αξιολόγηση Φροντιστηριακού Μαθήματος / Επικουρικού Διδακτικού Προσωπικού'
// }
// };

// var chart = new ApexCharts(document.querySelector(".chartEvalTutoringCourse"), options);
// chart.render();

var options = {
  series: [{
  name: 'Βαθμός 0',
  data: [2, 55,1,2,3,4,5,6,7,8,9,11]
}, {
  name: 'Βαθμός 1',
  data: [1, 55,1,2,3,4,5,6,7,8,9,11]
}, {
  name: 'Βαθμός 2',
  data: [3, 55,1,2,3,4,5,6,7,8,9,11]
},{
  name: 'Βαθμός 3',
  data: [4, 55,1,2,3,4,5,6,7,8,9,11]
},{
  name: 'Βαθμός 4',
  data: [5, 55,1,2,3,4,5,6,7,8,9,11]
},{
  name: 'Βαθμός 5',
  data: [6, 55,1,2,3,4,5,6,7,8,9,11]
}],
  chart: {
  type: 'bar',
  height: 400,
  offsetX: -190,
  width: 1000,
  stacked: true,
  stackType: '100%'
},
responsive: [{
  breakpoint: 480,
  options: {
    legend: {
      position: 'bottom',
      offsetX: -10,
      offsetY: 0
    }
  }
}],
plotOptions: {
  bar: {
    horizontal: true,
  },
},
colors: [''],
xaxis: {
  categories: ['Η συνολική απόδοση του διδάσκοντα ήταν καλή;', 'Η ποιότητα του μαθήματος ήταν υψηλή;','Η οργάνωση και παρουσίαση του μαθήματος ήταν άρτια;', 'Το αντικείμενο του μαθήματος ήταν ενδιαφέρον και χρήσιμο για τις σπουδές σας;', 'Το διδακτικό υλικό (βιβλία, σημειώσεις, ασκήσεις, άρθρα κ.λπ.) ήταν επαρκές για τις ανάγκες του μαθήματος;', 'Ο καθηγητής ερχόταν στο μάθημα προετοιμασμένος;', 'Η μεταδοτικότητα του διδάσκοντα ήταν καλή;', 'Ενθάρρυνε τις ερωτήσεις και ευρύτερα τη συμμετοχή στο μάθημα;', 'Όποτε χρειάστηκα να λύσω απορίες/προβλήματα βρήκα τον καθηγητή στις ώρες γραφείου του;', 'Ο διδάσκων ήταν συνεπής στις παρουσίες του στα μαθήματα;','Η ποιότητα του φροντιστηριακού μαθήματος ήταν υψηλή;','Η συνολική απόδοση του επικουρικού διδακτικού προσωπικού ήταν καλή;'],
},
fill: {
  opacity: 1
},
legend: {
  position: 'top',
  offsetX: 115,
  offsetY: 0
},
title: {
  text: "",
  offsetX: 225,
}
};


let result_array = [];
let array = [];
let button;
let subjects = [];


window.onload = () => {
  var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            const dbResult = this.responseText;
            if (dbResult != "Query failed"){
              result_array = dbResult.split(".");

              result_array.forEach(r => {
                let temp = r.split(",");
                array.push(temp.slice(1, temp.length-2));
                let subject_id = temp[0];
                let subject_title = temp[temp.length-1];

                let subject_object = {
                  "id": subject_id,
                  "title": subject_title
                };

                let flag = true;
                for(i=0;i<subjects.length;i++){
                  if(subjects[i].id == subject_object.id){
                    flag= false;
                    break;
                  }
                }
                if(flag){
                  subjects.push(subject_object);
                }
              });

              buttonCreator();
                
            }
        }
    };
    xmlhttp.open("GET", "assets/backend/evaluation_results.php",true);
    xmlhttp.send();
  }

  
  function buttonCreator(){
    subjects.forEach(r => {
      button = document.createElement("button");
      button.setAttribute("id", r.id);
      button.setAttribute("onclick", "genChart()");
      button.innerHTML = r.title;
      document.body.appendChild(button);
      
    });
  }

  function genChart(){

    console.log(array);
    let results = [];
    for(let i = 0; i < 12; i++) {
      let counter = {
          "0": 0,
          "1": 0,
          "2": 0,
          "3": 0,
          "4": 0,
          "5": 0
      }
      array.forEach(row => {
          counter[row[i]]++; 
      })
      results.push(counter);
    }

    console.log(results);

    for(let j=0;j<6;j++){
      for(let i=0;i<12;i++){
        options.series[j].data[i] = results[i][j];
      }
    }
    


    
    var chart = new ApexCharts(document.querySelector(".chart"), options);
    chart.render();
  }